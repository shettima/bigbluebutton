#summary How to install BigBlueButton like a real developer.  :-)

This guide shows you how to  install !BigBlueButton from source on Ubuntu 10.04.1 32-bit.    If you are using CentOS, see [InstallingBigBlueButtonCentOS InstallingBigBlueButtonCentOS].  In most cases, you'll want to install from [http://code.google.com/p/bigbluebutton/wiki/InstallationUbuntu packages], but if you want to really understand how !BigBlueButton is setup, go through the step-by-step instructions below and you'll become familiar with each component.  

To start, you'll need a computer running Ubuntu -- either a physical machine or a virtual machine (VM).  If you are on Windows, the easiest way to start is to download a Ubuntu 10.04 Server VM image from http://www.vmware.com/appliances/directory/va/542303/download and start it in VMWare Player.  You don't have to use VMWare Player, Virtual Box is another excellent tool for running VMs.

When you boot your Ubuntu VM, it needs to have a network IP that you can access from another computer (such as the host computer running the VM).

*The instructions below assumes you have downloaded the VM image above and running it on WMWare.*

== Log in as root ==

Log in as root to avoid having to type sudo in front of most of the commands required to install !BigBlueButton.
{{{
sudo -i
}}}

== Check if you have a internet connection ==

{{{
ping www.google.com
}}}

If you get an error saying your eth0 is not connected, check if the VM is using eth1:

{{{
ifconfig -a
}}}

If it shows the following:

{{{
eth1      Link encap:Ethernet  HWaddr 00:0c:29:dd:b4:51
          inet addr:192.168.0.154  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::20c:29ff:fedd:b451/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:4080349 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3932137 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:1216680270 (1.2 GB)  TX bytes:822963271 (822.9 MB)
          Interrupt:19 Base address:0x2000

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:12938 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12938 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:40299608 (40.2 MB)  TX bytes:40299608 (40.2 MB)
}}}

Make it use eth0 instead
{{{
vi /etc/udev/rules.d/70-persistent-net.rules
}}}

This will show:
{{{
# This file was automatically generated by the /lib/udev/write_net_rules
# program, run by the persistent-net-generator.rules rules file.
#
# You can modify it, as long as you keep each rule on a single
# line, and change only the value of the NAME= key.

# PCI device 0x1022:0x2000 (pcnet32)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="00:0c:29:23:d1:b3", ATTR{type}=="1", KERNEL=="eth*", NAME="eth1"

# PCI device 0x1022:0x2000 (pcnet32)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="00:0c:29:dd:b4:51", ATTR{type}=="1", KERNEL=="eth*", NAME="eth0"

}}}

Swap the two entries by editing "NAME=eth1" to "NAME=eth0" and vice versa.

Reboot your machine. Check if you manage to connect to the internet. Make sure the VM's network adapter is using a Bridged connection instead of NAT. On the VMWare player this is enabled in the Devices menu at the top.

More info can be found here http://ubuntuforums.org/showthread.php?t=221768

== Update and Upgrade your VM ==

Once you have internet connection, update and upgrade your VM.
{{{
apt-get update
apt-get upgrade
}}}

== Install MySQL ==
{{{
apt-get install mysql-server
}}}
When prompted, enter a password for the MySQL root account and keep this handy.

== Install Tomcat ==
{{{
apt-get install tomcat6
}}}

Confirm that tomcat is running
{{{
http://<YOUR IP>:8080/

To determine your ip:
ifconfig

see "ifconfig -a" command above for output. Your ip should be the value of "inet addr:"  which from above is "192.168.0.154"
}}}

== Install swftools ==
{{{
apt-get install swftools
}}}

If the installer does not find the package swftools to install, you have to edit the sources.list file for apt and uncomment the partner repository.  To do this:

{{{
vi /etc/apt/sources.list
}}}

Once here, uncomment the partner repository

{{{
deb http://archive.canonical.com/ubuntu lucid partner
}}}

Run {{{apt-get update}}} then try installing it once more.

== Install !ImageMagick ==
{{{
apt-get install imagemagick
}}}

== Install Nginx ==
{{{
apt-get install nginx
}}}

== Install ActiveMQ ==
{{{
cd /tmp/bbb
wget http://apache.mirror.rafal.ca/activemq/apache-activemq/5.4.1/apache-activemq-5.4.1-bin.tar.gz
tar zxvf apache-activemq-5.4.1-bin.tar.gz
mv /tmp/bbb/apache-activemq-5.4.1 /usr/share/activemq
chown -R root:root /usr/share/activemq
}}}

ActiveMQ depends on Jsvc, to install:
{{{
apt-get install jsvc
}}}


== Install red5 ==
{{{
cd /tmp/bbb
wget http://bigbluebutton.org/downloads/0.70/red5-0.9.1.tar.gz
tar xvf red5-0.9.1.tar.gz
mv /tmp/bbb/red5-0.9.1 /usr/share/red5
}}}

Create red5 user
{{{
adduser --system --home /usr/share/red5 --no-create-home --group --disabled-password --shell /bin/false red5
}}}

Assign proper permissions
{{{
chown -R root:root /usr/share/red5
chown -R red5:adm /usr/share/red5/log
chmod 755 /usr/share/red5/log
chgrp red5 /usr/share/red5/webapps
chmod 775 /usr/share/red5/webapps
}}}

== Auto-start ActiveMQ and Red5 on reboot ==
{{{
cd /tmp/bbb/
wget http://bigbluebutton.org/downloads/0.71/init-scripts.tar.gz
tar xzvf init-scripts.tar.gz
cd /etc/init.d/
mv activemq /etc/init.d/activemq
mv red5 /etc/init.d/red5
chmod +x /etc/init.d/activemq
chmod +x /etc/init.d/red5
update-rc.d activemq defaults
update-rc.d red5 defaults
}}}

== Install FreeSWITCH ==
!BigBlueButton uses an external conferencing server to handle voice calls.  FreeSWITCH allows !BigBlueButton to be integrated with a PBX system and when configured properly, can accept incoming calls from a SIP trunking provider.  Since FreeSWITCH isn't in the Ubuntu repositories we need to add it to our sources.  To do this:
{{{
apt-get install python-software-properties
add-apt-repository ppa:freeswitch-drivers/freeswitch-nightly-drivers 
apt-get update
apt-get install freeswitch freeswitch-lang-en
}}}

== Configure FreeSWITCH ==
{{{
cd /tmp/bbb/
wget http://bigbluebutton.org/downloads/0.71/freeswitch-config.tar.gz
cd /opt/freeswitch/
tar xzvf /tmp/bbb/freeswitch-config.tar.gz
chown -R freeswitch:daemon conf
chmod -R 755 conf
sed -i 's/FREESWITCH_ENABLED=\"false\"/FREESWITCH_ENABLED=\"true\"/g' /etc/default/freeswitch
}}}

== Configure Nginx ==
Be sure to replace < YOUR-IP > with your IP or domain.
{{{
cd /tmp/bbb
wget http://bigbluebutton.org/downloads/0.70/nginx-bigbluebutton.conf
cat nginx-bigbluebutton.conf  | sed "s/192.168.0.211/< YOUR-IP >/" > /etc/nginx/sites-available/bigbluebutton
}}}

== Enable the bigbluebutton nginx config ==
{{{
ln -s /etc/nginx/sites-available/bigbluebutton /etc/nginx/sites-enabled/bigbluebutton
}}}

== Install !OpenOffice ==
{{{
apt-get install openoffice.org
}}}

== Configure !OpenOffice to start as a service ==
{{{
cd /tmp/bbb
wget http://www.bigbluebutton.org/downloads/0.71/bbb-openoffice-headless
cp bbb-openoffice-headless /etc/init.d/
}}}
Start the !OpenOffice.org server
{{{
chmod +x /etc/init.d/bbb-openoffice-headless
update-rc.d bbb-openoffice-headless defaults
service bbb-openoffice-headless start
}}}



== Download !BigBlueButton ==
{{{ 
cd /tmp/bbb
wget http://bigbluebutton.org/downloads/0.71/bigbluebutton.tar.gz
tar xzvf bigbluebutton.tar.gz
}}}
	
== Disable Security settings for TOMCAT6 ==
{{{		
cat /etc/default/tomcat6 | sed "s/#TOMCAT6_SECURITY=yes/TOMCAT6_SECURITY=no/" > /tmp/bbb/tomcat6
mv -f /tmp/bbb/tomcat6 /etc/default/tomcat6		
}}}

== Setup the database ==
{{{
mysql -u root -p
}}}

This is an important step. If you skip this, !BigBlueButton will not work at all.
Just hit "Enter" when prompted for a password if you didn't enter one, otherwise use the root password you added ealier.

On the {{{mysql>}}} prompt, type
{{{
create database bigbluebutton_dev;

grant all on bigbluebutton_dev.* to 'bbb'@'localhost' identified by 'secret';

flush privileges;

quit
}}}

== Install bbb-web ==
{{{
cp /tmp/bbb/bigbluebutton.war /var/lib/tomcat6/webapps/bigbluebutton.war
}}}

== Determine PDF2SWF, CONVERT and GS applications ==
Make a note of where pdf2swf is installed
{{{
which pdf2swf
}}}
You should see something like
{{{
/usr/bin/pdf2swf
}}}
Make a note of where the convert application is installed
{{{
which convert
}}}
You shoud see something like.
{{{
/usr/bin/convert
}}}
Note where GhostScript is installed
{{{
which gs
}}}
You shoud see something like.
{{{
/usr/bin/gs
}}}

== Generate a GUID ==

For security, you need to generate a GUID. You can use an online GUID generator, such as [http://www.somacon.com/p113.php this one]. Keep this GUID handy as we will need it shortly.  You will need to generate a *HEX Encoded* string and copy it _minus_ the *0x*.

== Edit bbb-web properties ==
{{{
vi /var/lib/tomcat6/webapps/bigbluebutton/WEB-INF/classes/bigbluebutton.properties
}}}

Change the following:
 * swfToolsDir to the *directory* where pdf2swf is located
 * imageMagickDir to the *directory* where convert is located
 * ghostScriptExec to point to the gs *executable*
 * change bigbluebutton.web.serverURL=http://<YOUR IP>
 * set beans.dynamicConferenceService.securitySalt to be equal to the guid we just generated (i.e. beans.dynamicConferenceService.securitySalt=< YOUR-GUID >)

== Create noPdfMarkWorkaround.ps ==
Create {{{/etc/bigbluebutton/nopdfmark.ps}}} with the following content:

{{{
%!
/pdfmark {cleartomark} bind def
}}}

== Restart Tomcat6 ==
{{{
service tomcat6 restart
}}}

== Check if database tables were created ==
{{{
 > mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 56
Server version: 5.0.75-0ubuntu10.2 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql> use bigbluebutton_dev;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+-----------------------------+
| Tables_in_bigbluebutton_dev |
+-----------------------------+
| account                     |
| account_conference          |
| account_user                |
| conference                  |
| permission                  |
| role                        |
| role_permission_rel         |
| scheduled_session           |
| user                        |
| user_permission_rel         |
| user_role_rel               |
| voice_conference_bridge     |
+-----------------------------+
12 rows in set (0.00 sec)

mysql> select * from user;
+----+---------+---------------------+-----------+---------------------+------------------------------------------+----------------+
| id | version | date_created        | full_name | last_updated        | password_hash                            | username       |
+----+---------+---------------------+-----------+---------------------+------------------------------------------+----------------+
|  1 |       0 | 2009-06-29 09:51:17 | Admin     | 2009-06-29 09:51:17 | d033e22ae348aeb5660fc2140aec35850c4da997 | admin@test.com |
+----+---------+---------------------+-----------+---------------------+------------------------------------------+----------------+
1 row in set (0.02 sec)

mysql>
}}}

== Create the Presentation Upload directory ==
{{{
mkdir /var/bigbluebutton
chown -R tomcat6:adm /var/bigbluebutton
chmod -R 777 /var/bigbluebutton
}}}

== Install bbb-apps ==
{{{ 
tar xzvf bigbluebutton-webapps.tar.gz
mv bigbluebutton /usr/share/red5/webapps
}}}

== Install bbb-deskshare-app ==
{{{
tar xzvf deskshare.tar.gz
mv deskshare /usr/share/red5/webapps/
}}}

== Install bbb-video-app ==
{{{
tar xzvf video.tar.gz
mv video /usr/share/red5/webapps/
}}}

== Install bbb-voice-app ==
{{{
tar xzvf sip.tar.gz
mv sip /usr/share/red5/webapps/
}}}

At this point we have to edit one of the configuration files to point to your sip server.  This document assumes it is your current machine, but it can be another stand alone machine all you need is its IP address.

Open the file
{{{
vi /usr/share/red5/webapps/sip/WEB-INF/bigbluebutton-sip.properties
}}}
Edit the line that says {{{sip.server.host=192.168.0.211}}} and replace the IP with < Your-IP >.

== Install bbb-default ==
{{{
tar xzvf bbb-default.tar.gz
mv bigbluebutton-default /var/www
}}}

Now we need to create bbb_api_conf.jsp, which will hold our GUID and the !BigBlueButtonURL. Be sure to replace < YOUR-GUID > and < YOUR-IP > with the GUID we generated earlier and your IP, respectively.
{{{
echo "<%!
// This is the security salt that must match the value set in the BigBlueButton server
String salt = \"<YOUR-GUID>\";

// This is the URL for the BigBlueButton server
String BigBlueButtonURL = \"http://<YOUR-IP>/bigbluebutton/\";
%>" > /var/lib/tomcat6/webapps/bigbluebutton/demo/bbb_api_conf.jsp

}}}

== Install bbb-client ==
{{{
cd /tmp/bbb
tar xzvf client.tar.gz
mv client /var/www/bigbluebutton
}}}

== Edit client config ==
  
{{{
vi /var/www/bigbluebutton/client/conf/config.xml
}}}

 * Change the uri to your IP address

Your config.xml should look something like:
{{{
<?xml version="1.0" ?>
<config>
    <localeversion>0.7</localeversion>
    <version>3764-2010-10-20</version>
    <help url="http://192.168.0.211/help.html"/>
    <porttest host="192.168.0.211" application="video"/>
    <application uri="rtmp://192.168.0.211/bigbluebutton" host="http://192.168.0.211/bigbluebutton/api/enter" />
    <language userSelectionEnabled="true" />
    <skinning enabled="false" url="branding/css/theme.swf" />
    <debug showDebugWindow="false" />

        <modules>

                <module name="ChatModule" url="ChatModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/bigbluebutton"
                        dependsOn="ViewersModule"
                        translationOn="true"
                        translationEnabled="true"
                />

                <module name="ViewersModule" url="ViewersModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/bigbluebutton"
                        host="http://192.168.0.211/bigbluebutton/api/enter"
                        allowKickUser="true"
                />

                <module name="ListenersModule" url="ListenersModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/bigbluebutton"
                        recordingHost="http://192.168.0.211"
                />

                <module name="DeskShareModule"
                        url="DeskShareModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/deskShare"
                />

                <module name="PhoneModule" url="PhoneModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/sip"
                        dependsOn="ViewersModule"
                />

                <module name="VideoconfModule" url="VideoconfModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/video"
                        dependsOn="ViewersModule"
                        videoQuality="100"
                        presenterShareOnly="false"
                />

                <module name="WhiteboardModule" url="WhiteboardModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/bigbluebutton"
                        dependsOn="PresentModule"
                />

                <module name="PresentModule" url="PresentModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/bigbluebutton"
                        host="http://192.168.0.211"
                        dependsOn="ViewersModule"
                />

                <!--<module name="ExampleChatModule" url="ExampleChatModule.swf?v=56"
            uri="rtmp://192.168.0.211/bigbluebutton"
            host="http://192.168.0.211"
                />-->

                <!--<module name="BreakoutModule" url="BreakoutModule.swf?v=3764"
                        uri="rtmp://192.168.0.211/bigbluebutton"
                        host="http://192.168.0.211"
                        dependsOn="ViewersModule"
                        salt="1708e5ecf25b7142b06f2338b4ea3cf1"
                />-->

        </modules>
</config>
}}}

Hint: if you are using vi you can use a command similar to this: :1,$s/192.168.0.211/< YOUR-IP >/g


=== Install bbb-conf ===

The utility `bbb-conf` is a shell script to help you configure your !BigBlueButton setup.  To install `bbb-conf`, do the following:

{{{ 
cd /tmp/bbb
wget http://github.com/bigbluebutton/bigbluebutton/raw/master/bigbluebutton-config/bin/bbb-conf
sudo mv bbb-conf /usr/local/bin 
sudo chmod a+x /usr/local/bin/bbb-conf 
}}}

You should now be able to type
{{{
bbb-conf -c
}}}

== Finish the installation ==
{{{
# create directory for log files
mkdir /var/log/bigbluebutton

# create an empty log file
touch /var/log/bigbluebutton/bbb-web.log
chown tomcat6:tomcat6 /var/log/bigbluebutton/bbb-web.log

# restart server

service nginx restart
service activemq restart
service freeswitch restart
service red5 restart
service tomcat6 restart
}}}


== Try out !BigBlueButton ==

 Go to {{{http://<YOUR-IP>}}} which should display the bbb web page and join the conference!

== When things go wrong ==
 Look for logs in the following
{{{
 /var/log/syslog
 /var/log/tomcat6
 /usr/share/red5/log
 /opt/freeswich/log
}}}

Also ensure that port 1935 (RTMP) and port 9123 (desktop sharing) are open on your server.

== If you make it successfully through the installation ==
Good stuff!  Post a message to !BigBlueButton-setup letting everyone know that you are a real developer and you have installed !BigBlueButton from source.  :-)

== Startup execution of scripts ==

Use this command in /etc/init.d/ on the scripts activemq and red5 to setup the startup execution of these scripts.  The 99 is priority, so to make red5 start after activemq, use 98 for the priority of red5.

{{{
update-rc.d -f script_name start 99 2 3 4 5 .
}}}

You also might need to do this with the tomcat6 script as well if it is not starting up on reboot.

== Using !MeetMe ==
*NOTE:* You only need to through the steps below if you want to use meetme instead of appKonference.

By default, !BigBlueButton uses AppKonference for voice conferencing. If you wish to use MeetMe instead, you need to install dahdi and enable MeetMe in !BigBlueButton's configuration.

=== Install Dahdi ===

You may have to find out what the newest version is. Go to http://downloads.asterisk.org/pub/telephony/dahdi-linux-complete

{{{
 cd /usr/local/src
 wget http://downloads.asterisk.org/pub/telephony/dahdi-linux-complete/dahdi-linux-complete-2.2.1-rc2+2.2.1-rc2.tar.gz
 tar zxvf dahdi-linux-complete-2.2.1-rc2+2.2.1-rc2.tar.gz
 cd dahdi-linux-complete-2.2.1-rc2+2.2.1-rc2
 sudo apt-get install linux-headers-2.6.28-17-server
 make all
 make install
 make config
}}}

This command will change based on what version of kernel you are using, if you get an error when doing "make all" asking for missing linux headers then you have to changed this command to appropriate.  You can use {{{apt-cache search linux-headers}}} to find the available linux-headers
{{{
sudo apt-get install linux-headers-2.6.28-17-server
}}}

=== Enable MeetMe ===

You can change !BigBlueButton's configuration to use MeetMe by executing the following commands.
{{{
 sed -i "s/asterisk.application[ ]*=.*/asterisk.application=meetme/g" \
                        /usr/share/red5/webapps/bigbluebutton/WEB-INF/bigbluebutton.properties

# update /etc/asterisk/bbb_extensions.conf
 sed -i "s/^exten => _XXXX.,n,Konference(\${EXTEN},H)/# exten => _XXXX.,n,Konference(\${EXTEN},H)/g" \
 /etc/asterisk/bbb_extensions.conf

 sed -i "s/#[ ]*exten => _XXXX.,n,MeetMe(\${EXTEN},cdMsT)/exten => _XXXX.,n,MeetMe(\${EXTEN},cdMsT)/g" \
 /etc/asterisk/bbb_extensions.conf

# update /etc/asterisk/bbb_extensions.conf
 sudo sed -i "s/# exten => _XXXX.,n,MeetMe(\${CONFERENCE_FOUND},cdMsT)/exten => _XXXX.,n,MeetMe(\${CONFERENCE_FOUND},cdMsT)/g" \
 /etc/asterisk/bbb_extensions.conf

 sudo sed -i "s/^exten => _XXXX.,n,Konference(\${CONFERENCE_FOUND},H)/# exten => _XXXX.,n,Konference(\${CONFERENCE_FOUND},H)/g" \
 /etc/asterisk/bbb_extensions.conf
}}}


To check the current setup of !BigBlueButton.  For more options, see [BBBConf manual page for bbb-conf]. 