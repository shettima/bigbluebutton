#summary How to install BigBlueButton like a real developer.  :-)

This guide shows you how to  install !BigBlueButton from source on Ubuntu.    If you are using CentOS, see [InstallingBigBlueButtonCentOS InstallingBigBlueButtonCentOS].  In most cases, you'll want to install from [http://code.google.com/p/bigbluebutton/wiki/InstallationUbuntu packages], but if you want to really understand how !BigBlueButton is setup, go through the step-by-step instructions below and you'll become familiar with each component.  

To start, you'll need a computer running Ubuntu -- either a physical machine or a virtual machine (VM).  If you are on Windows, the easiest way to start is to download a Ubuntu 9.04 Server VM image from http://www.vmware.com/appliances/directory/va/147323/download and start it in VMWare Player.  You don't have to use VMWare Player, Virtual Box is another excellent tool for running VMs.

When you boot your Ubuntu VM, it needs to have a network IP that you can access from another computer (such as the host computer running the VM).

*The instructions below assumes you have downloaded the VM image above and running it on WMWare.*

== Log in as root ==

Log in as root to avoid having to type sudo in front of most of the commands required to install BigBlueButton.
{{{
sudo su - root
}}}

== Check if you have a internet connection ==

{{{
  ping www.google.com
}}}

If you get an error saying your eth0 is not connected, check if the VM is using eth1:

{{{
 ifconfig -a
}}}

If it shows the following:

{{{
eth1      Link encap:Ethernet  HWaddr 00:0c:29:dd:b4:51
          inet addr:192.168.0.154  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::20c:29ff:fedd:b451/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:4080349 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3932137 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:1216680270 (1.2 GB)  TX bytes:822963271 (822.9 MB)
          Interrupt:19 Base address:0x2000

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:12938 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12938 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:40299608 (40.2 MB)  TX bytes:40299608 (40.2 MB)
}}}

Make it use eth0 instead
{{{
 vi /etc/udev/rules.d/70-persistent-net.rules
}}}

This will show:
{{{
# This file was automatically generated by the /lib/udev/write_net_rules
# program, run by the persistent-net-generator.rules rules file.
#
# You can modify it, as long as you keep each rule on a single
# line, and change only the value of the NAME= key.

# PCI device 0x1022:0x2000 (pcnet32)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="00:0c:29:23:d1:b3", ATTR{type}=="1", KERNEL=="eth*", NAME="eth1"

# PCI device 0x1022:0x2000 (pcnet32)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="00:0c:29:dd:b4:51", ATTR{type}=="1", KERNEL=="eth*", NAME="eth0"

}}}

Swap the two entries by editing "NAME=eth1" to "NAME=eth0" and vice versa.

Reboot your machine. Check if you manage to connect to the internet. Make sure the VM's network adapter is using a Bridged connection instead of NAT. On the VMWare player this is enabled in the Devices menu at the top.

More info can be found here http://ubuntuforums.org/showthread.php?t=221768

== Update and Upgrade your VM ==

 Once you have internet connection, update and upgrade your VM.
{{{
   sudo apt-get update
   sudo apt-get upgrade
}}}

== Install Java 6 ==
{{{
  apt-get install openjdk-6-jre-headless
}}}

== Install MySQL ==
{{{
  apt-get install mysql-server
}}}

== Install Tomcat ==
{{{
   apt-get install tomcat6
}}}

 Confirm that tomcat is running
{{{
  http://<YOUR IP>:8080/

  To determine your ip:
  ifconfig

  see "ifconfig -a" command above for output. Your ip should be the value of "inet addr:"  which from above is "192.168.0.154"
}}}

== Install swftools ==
{{{
   apt-get install swftools
}}}

== Install ImageMagick ==
{{{
   apt-get install imagemagick
}}}

== Install Nginx ==
{{{
   apt-get install nginx
}}}

== Install ActiveMQ ==
{{{
   cd /tmp
   wget http://apache.mirror.rafal.ca/activemq/apache-activemq/5.2.0/apache-activemq-5.2.0-bin.tar.gz
   tar zxvf apache-activemq-5.2.0-bin.tar.gz
   mv /tmp/apache-activemq-5.2.0 /usr/share/activemq
   chown -R root.root /usr/share/activemq
}}}


== Install red5 ==
{{{
  cd /tmp
  wget http://build.xuggle.com/job/red5_jdk6_stable/131/artifact/workingcopy/red5-0.8.RC3-build-hudson-red5_jdk6_stable-131.tar.gz
  tar zxvf red5-0.8.RC3-build-hudson-red5_jdk6_stable-131.tar.gz
  mv /tmp/red5-0.8.RC3-build-hudson-red5_jdk6_stable-131 /usr/share/red5
  mkdir /usr/share/red5/work
}}}

Create red5 user
{{{
   adduser --system --home /usr/share/red5 --no-create-home --group --disabled-password --shell /bin/false red5
}}}

Assign proper permissions
{{{
  chown -R root.root /usr/share/red5
  chown -R red5:adm /usr/share/red5/log
  chmod 755 /usr/share/red5/log
  chown -R red5:adm /usr/share/red5/work
  chmod 755 /usr/share/red5/work
  chgrp red5 /usr/share/red5/webapps
  chmod 775 /usr/share/red5/webapps
}}}

== Auto-start ActiveMQ and Red5 on reboot ==
{{{
  cd /tmp/
  wget http://bigbluebutton.googlecode.com/files/red5-ubuntu
  wget http://bigbluebutton.googlecode.com/files/activemq-ubuntu
  cd /etc/init.d/
  cp /tmp/activemq-ubuntu ./activemq
  cp /tmp/red5-ubuntu ./red5
  sudo chmod +x red5
  sudo chmod +x activemq

  apt-get -y install chkconfig
  chkconfig red5 on
  chkconfig activemq on
}}}

Run red5

{{{
  sudo ./red5 start
}}}

== Install oflaDemo to test if Red5 works ==
From your browser, visit

{{{
http://<IP>:5080/
}}}

Click on "Click here to install demos" and then choose oflaDemo java 6.

Once the demo has been installed, visit
{{{
http://<IP>:5080/demos/ofla_demo.html
}}}

Edit rtmp://< IP >/oflaDemo and click connect

You would see a list of available videos. Select one to play.

== Install Asterisk ==
{{{
  apt-get -y install asterisk
}}}


== Modify Extensions ==
{{{

# configure asterisk
wget http://bigbluebutton.org/downloads/0.63/bbb_extensions.conf
mv bbb_extensions.conf /etc/asterisk/
echo "#include \"bbb_extensions.conf\"" >> /etc/asterisk/extensions.conf

wget http://bigbluebutton.org/downloads/0.63/bbb_sip.conf
mv bbb_sip.conf /etc/asterisk/bbb_sip.conf
echo "#include \"bbb_sip.conf\"" >> /etc/asterisk/sip.conf

wget http://bigbluebutton.org/downloads/0.63/app_konference.so
mv app_konference.so /usr/lib/asterisk/modules/
chmod 755 /usr/lib/asterisk/modules/app_konference.so

wget http://bigbluebutton.googlecode.com/svn/trunk/bbb-images/centos-install-files/asterisk-create-sip-accounts.sh
chmod a+x asterisk-create-sip-accounts.sh
./asterisk-create-sip-accounts.sh

# set enabled to yes in manager.conf
cat /etc/asterisk/manager.conf | sed 's/^enabled = no/enabled = yes/' > /tmp/manager.conf
mv -f /tmp/manager.conf /etc/asterisk/


}}}

Please take a peek at {{{asterisk-extensions.conf}}} to see what it does.

== Create SIP accounts ==
{{{
cd /etc/asterisk
wget http://bigbluebutton.org/downloads/0.63/bbb_sip.conf
echo "#include \"bbb_sip.conf\"" >> /etc/asterisk/sip.conf

}}}

Please take a peek at {{{asterisk-sip.conf}}} to see what it does.

== Create SIP Accounts to be used by !Red5Phone ==
{{{

wget http://bigbluebutton.googlecode.com/files/asterisk-create-sip-accounts.sh
chmod a+x asterisk-create-sip-accounts.sh
./asterisk-create-sip-accounts.sh

}}}

Please take a peek at {{{asterisk-create-sip-accounts.sh}}} to see what it does.

== Create AMI account ==
Set enabled to yes in manager.conf
{{{
  cat /etc/asterisk/manager.conf | sed 's/^enabled = no/enabled = yes/' > /tmp/manager.conf
mv -f /tmp/manager.conf /etc/asterisk/
}}}

Add account to manager.conf
{{{
echo "
; BigBlueButton: Enable Red5 to connect
[bbb]
secret = secret
permit = 0.0.0.0/0.0.0.0
read = system,call,log,verbose,command,agent,user
write = system,call,log,verbose,command,agent,user
" >> /etc/asterisk/manager.d/bigbluebutton.conf

echo "#include \"manager.d/*.conf\"" >> /etc/asterisk/manager.conf
}}}

== Configure Nginx ==
Be sure to replace < YOUR-IP > with your IP or domain.
{{{
  wget http://bigbluebutton.org/downloads/0.63/nginx-bigbluebutton.conf
  cat nginx-bigbluebutton.conf  | sed "s/192.168.0.136/<YOUR-IP>/" > /etc/nginx/sites-available/bigbluebutton
  rm nginx-bigbluebutton.conf
}}}

== Enable the bigbluebutton nginx config ==
{{{
 ln -s /etc/nginx/sites-available/bigbluebutton /etc/nginx/sites-enabled/bigbluebutton
}}}

== Download !BigBlueButton ==
{{{ 
 cd /tmp
 wget http://www.bigbluebutton.org/sites/all/releases/latest-release/bigbluebutton-apps.tar.gz
 wget http://www.bigbluebutton.org/sites/all/releases/latest-release/deskshare.tar.gz
 wget http://www.bigbluebutton.org/sites/all/releases/latest-release/client.tar.gz
 wget http://www.bigbluebutton.org/sites/all/releases/latest-release/bigbluebutton.war
 wget http://www.bigbluebutton.org/sites/all/releases/latest-release/sip.tar.gz
 wget http://www.bigbluebutton.org/sites/all/releases/latest-release/video.tar.gz
 wget http://www.bigbluebutton.org/sites/all/releases/latest-release/bbb-default.tar.gz
}}}

		
== Disable Security settings for TOMCAT6 ==
{{{		
  vi /etc/default/tomcat6		

  Edit and uncomment #TOMCAT6_SECURITY=yes to		
			
  TOMCAT6_SECURITY=no		
}}}

== Setup the database ==
{{{
  mysql -u root -p
}}}

Just hit "Enter" when prompted for a password.

On the {{{mysql>}}} prompt, type
{{{
 create database bigbluebutton_dev;

 grant all on bigbluebutton_dev.* to 'bbb'@'localhost' identified by 'secret';

 commit;

 quit
}}}

== Install bbb-web ==
{{{
  cd /var/lib/tomcat6/webapps
  cp /tmp/bigbluebutton.war ./bigbluebutton.war
}}}

== Determine PDF2SWF, CONVERT and GS applications ==
{{{
  Make a note of where pdf2swf is installed
   which pdf2swf
  
  You should see something like
  /usr/bin/pdf2swf
  
  Make a note of where the convert application is installed
   which convert

  You shoud see something like.
  /usr/bin/convert

  Note where GhostScript is installed
   which gs

  You shoud see something like.
  /usr/bin/gs
}}}

== Edit bbb-web properties ==
{{{
  vi /var/lib/tomcat6/webapps/bigbluebutton/WEB-INF/classes/bigbluebutton.properties
}}}

Change the following:
 * swfToolsDir to the directory where pdf2swf is located
 * imageMagickDir to the directory where convert is located
 * ghostScriptExec to point to the gs application
 * change bigbluebutton.web.serverURL=http://<YOUR IP>

Your bigbluebutton.properties should resemble something like this

{{{
#
# These are the default properites for BigBlueButton Web application

dataSource.url=jdbc:mysql://localhost/bigbluebutton_dev
dataSource.username=bbb
dataSource.password=secret

# Directory where BigBlueButton stores uploaded slides
presentationDir=/var/bigbluebutton

# Directory where SWFTOOLS (pdf2swf, jpeg2swf, png2swf) are located
swfToolsDir=/bin

# Directory where ImageMagick's convert executable is located
imageMagickDir=/usr/bin

# Use fullpath to ghostscript executable since the exec names are different
# for each platform.
ghostScriptExec=/usr/bin/gs

# This is a workaround for a problem converting PDF files, referenced at 
# http://groups.google.com/group/comp.lang.postscript/browse_thread/thread/c2e264ca76534ce0?pli=1
noPdfMarkWorkaround=/etc/bigbluebutton/nopdfmark.ps

# These will be copied in cases where the conversion process
# fails to generate a slide from the uploaded presentation
BLANK_SLIDE = /var/bigbluebutton/blank/blank-slide.swf
BLANK_THUMBNAIL = /var/bigbluebutton/blank/blank-thumb.png

# Inject the above properties into the PresentationService bean	
beans.presentationService.swfToolsDir=${swfToolsDir}
beans.presentationService.imageMagickDir=${imageMagickDir}
beans.presentationService.presentationDir=${presentationDir}
beans.presentationService.ghostScriptExec=${ghostScriptExec}
beans.presentationService.noPdfMarkWorkaround=${noPdfMarkWorkaround}
beans.presentationService.BLANK_THUMBNAIL=${BLANK_THUMBNAIL}
beans.presentationService.BLANK_SLIDE=${BLANK_SLIDE}

beans.adhocConferenceService.serviceEnabled = true
beans.dynamicConferenceService.serviceEnabled = true

#
# This URL is where the BBB client is accessible. When a user sucessfully
# enters a name and password, she is redirected here to load the client.
bigbluebutton.web.serverURL=http://< YOUR-IP>

# URL where the logged-out participant will be redirected after sign-out
bigbluebutton.web.loggedOutUrl=http://www.bigbluebutton.org
}}}

== Create noPdfMarkWorkaround.ps ==
Create {{{/etc/bigbluebutton/nopdfmark.ps}}} with the following content:

{{{
%!
/pdfmark {cleartomark} bind def
}}}

== Restart Tomcat6 ==
{{{
  /etc/init.d/tomcat6 restart
}}}

== Check if database tables were created ==
{{{
 > mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 56
Server version: 5.0.75-0ubuntu10.2 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql> use bigbluebutton_dev;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+-----------------------------+
| Tables_in_bigbluebutton_dev |
+-----------------------------+
| account                     |
| account_conference          |
| account_user                |
| conference                  |
| permission                  |
| role                        |
| role_permission_rel         |
| scheduled_session           |
| user                        |
| user_permission_rel         |
| user_role_rel               |
| voice_conference_bridge     |
+-----------------------------+
12 rows in set (0.00 sec)

mysql> select * from user;
+----+---------+---------------------+-----------+---------------------+------------------------------------------+----------------+
| id | version | date_created        | full_name | last_updated        | password_hash                            | username       |
+----+---------+---------------------+-----------+---------------------+------------------------------------------+----------------+
|  1 |       0 | 2009-06-29 09:51:17 | Admin     | 2009-06-29 09:51:17 | d033e22ae348aeb5660fc2140aec35850c4da997 | admin@test.com |
+----+---------+---------------------+-----------+---------------------+------------------------------------------+----------------+
1 row in set (0.02 sec)

mysql>
}}}

== Create the Presentation Upload directory ==
{{{
  mkdir /var/bigbluebutton
  chown -R tomcat6:adm /var/bigbluebutton
  chmod -R 777 /var/bigbluebutton
}}}

== Install bbb-apps ==
{{{
 cd /usr/share/red5/webapps
 cp /home/user/temp/bigbluebutton-apps.tar.gz ./
 
 tar zxvf bigbluebutton-apps.tar.gz
 mv webapps/bigbluebutton ./
 rm -rf bigbluebutton-apps.tar.gz webapps/
}}}

== Edit bbb-apps properties ==
{{{
 vi /usr/share/red5/webapps/bigbluebutton/WEB-INF/bigbluebutton.properties
}}}

Your properties file should look like this.
{{{
# Location for recordings
recordingsDirectory=/var/bigbluebutton

# These properties are for Asterisk Management Interface (AMI)
ami.host=127.0.0.1
ami.port=5038
ami.username=bbb
ami.password=secret
}}}

== Enable RTMP Tunneling ==
 Uncomment the RTMPT section (seen below) of /usr/share/red5/conf/red5-core.xml.

{{{
<!-- RTMPT -->
        <bean id="rtmpt.server" class="org.red5.server.net.rtmpt.TomcatRTMPTLoader" init-method="init" lazy-init="true">

                <property name="webappFolder" value="${red5.root}/webapps" />

                <property name="connector">
                        <bean class="org.apache.catalina.connector.Connector">
                                <constructor-arg type="java.lang.String" value="org.apache.coyote.http11.Http11NioProtocol" />
                                <property name="port"><value>${rtmpt.port}</value></property>
                                <property name="enableLookups"><value>false</value></property>
                        </bean>
                </property>

                <property name="connectionProperties">
                        <map>
                                <entry key="maxKeepAliveRequests" value="${rtmpt.max_keep_alive_requests}"/>
                                <entry key="useExecutor" value="true"/>
                                <entry key="maxThreads" value="${rtmpt.max_threads}"/>
                                <entry key="acceptorThreadCount" value="${rtmpt.acceptor_thread_count}"/>
                                <entry key="processorCache" value="${rtmpt.processor_cache}"/>
                        </map>
                </property>

                <property name="host">
                        <bean class="org.apache.catalina.core.StandardHost">
                                <property name="name" value="${rtmpt.host}" />
                                <property name="unpackWARs" value="false" />
                                <property name="autoDeploy" value="false" />
                                <property name="xmlValidation" value="false" />
                                <property name="xmlNamespaceAware" value="false" />
                        </bean>
                </property>

        </bean>
}}}

== Install bbb-deskshare-app ==
{{{
  cd /usr/share/red5/webapps
  cp /home/user/temp/deskshare.tar.gz ./
  tar zxvf deskshare.tar.gz
  rm deskshare.tar.gz
}}}

== Install bbb-video-app ==
{{{
  cd /usr/share/red5/webapps
  cp /home/user/temp/video.tar.gz ./
  tar zxvf video.tar.gz
  rm video.tar.gz
}}}

== Install bbb-voice-app ==
{{{
 cd /usr/share/red5/webapps
 cp /home/user/temp/sip.tar.gz ./
 tar zxvf sip.tar.gz
 rm sip.tar.gz
}}}

Edit properties
{{{
 vi /usr/share/red5/webapps/sip/WEB-INF/bigbluebutton-sip.properties
}}}

Your properties file should look like this.
{{{
# The address of your asterisk server
sip.server.host=127.0.0.1

# The start/stop SIP ports that the application is going
# to use to connect to the asterisk server
startSIPPort=5070
stopSIPPort=5099

# The start/stop RTP port the application is going to use
# for the media stream.
startRTPPort=3000
stopRTPPort=3029

# An extension pattern, in case your asterisk extensions.conf
# uses a naming convetion for your meeting rooms
# e.g. conf-85115 instead of just 85115		
callExtensionPattern={0}

}}}

== Install bbb-default ==
{{{
 cd /var/www
 cp /home/user/temp/bbb-default.tar.gz ./
 tar zxvf bbb-default.tar.gz
 mv web bigbluebutton-default
 rm bbb-default.tar.gz
}}}

== Install bbb-client ==
{{{
  cd /var/www
  mkdir bigbluebutton
  cd bigbluebutton 
  cp /home/user/temp/client.tar.gz ./
  tar zxvf client.tar.gz
  rm client.tar.gz
}}}

== Edit client config ==
  
{{{
 vi /var/www/bigbluebutton/client/conf/config.xml
}}}

 * Change the uri to your IP address

Your config.xml should look something like:
{{{
<?xml version="1.0" ?>
<config>
    <version>0.4</version>
    <porttest host="192.168.0.136" application="video"/>    
	<modules>

		<module name="VideoModule" url="VideoModule.swf" 
			uri="rtmp://192.168.0.136/video"
			onUserJoinedEvent="START"
			onUserLogoutEvent="STOP"	
		/>
		<module name="ChatModule" url="ChatModule.swf" 
			uri="rtmp://192.168.0.136/bigbluebutton" 
			loadNextModule="PresentationModule"	
			onUserJoinedEvent="START"
			onUserLogoutEvent="STOP"		 
		/>
		<module name="ViewersModule" url="ViewersModule.swf" 
			uri="rtmp://192.168.0.136/bigbluebutton" 
			host="http://192.168.0.136/bigbluebutton/conference-session/enter"
			onAppInitEvent="LOAD" loadNextModule="ChatModule"
			onAppStartEvent="START"
			onUserLogoutEvent="STOP"
		/>	
		<module name="ListenersModule" url="ListenersModule.swf" 
			uri="rtmp://192.168.0.136/bigbluebutton" 
			recordingHost="http://192.168.0.136"
			loadNextModule="DeskShareModule"
			onUserJoinedEvent="START"
			onUserLogoutEvent="STOP"
		/>
		<module name="PresentationModule" url="PresentationModule.swf" 
			uri="rtmp://192.168.0.136/bigbluebutton" 
			host="http://192.168.0.136" 
			loadNextModule="ListenersModule"
			onUserJoinedEvent="START" 
			onUserLogoutEvent="STOP"
		/>
		
		<module name="DeskShareModule" url="DeskShareModule.swf" 
			uri="rtmp://192.168.0.136/deskShare" 
			onUserJoinedEvent="START" 
			onUserLogoutEvent="STOP"
			loadNextModule="PhoneModule"
		/>
		
		<module name="PhoneModule" url="PhoneModule.swf" 
			uri="rtmp://192.168.0.136/sip" 
			onUserJoinedEvent="START" 
			onUserLogoutEvent="STOP"
			loadNextModule="VideoModule"
		/>
	</modules>
</config>
}}}

Hint: if you are using vi you can use a command similar to this: :1,$s/192.168.0.124/192.168.0.149/g

== Restart server ==

 * Start ActiveMQ
 * Start Red5
 * Start nginx
 * Restart dahdi
 * Restart Tomcat
 * Restart Asterisk 


== Try out !BigBlueButton ==

 Go to {{{http://<YOUR-IP>}}} which should display the bbb web page. Login into the default conference 85115.
 
 To use voice conference, using your zoiper, dial 85115 which will prompt you for the conference number.

== When things go wrong ==
 Look for logs in the following
{{{
 /var/log/syslog
 /var/log/tomcat6
 /usr/share/red5/log
 /var/log/asterisk
}}}

Also ensure that port 1935 (RTMP) and port 9123 (desktop sharing) are open on your server.

== If you make it successfully through the installation ==
Good stuff!  Post a message to BigBlueButton-dev letting everyone know that you are a real developer and you have installed BigBlueButton from source.  :-)

== Startup execution of scripts ==

Use this command in /etc/init.d/ on the scripts activemq and red5 to setup the startup execution of these scripts.  The 99 is priority, so to make red5 start after activemq, use 98 for the priority of red5.

{{{
update-rc.d -f script_name start 99 2 3 4 5 .
}}}

You also might need to do this with the tomcat6 script as well if it is not starting up on reboot.


== Install Dahdi ==
You may have to find out what the newest version is. Go to http://downloads.asterisk.org/pub/telephony/dahdi-linux-complete

{{{
 cd /usr/local/src
 wget http://downloads.asterisk.org/pub/telephony/dahdi-linux-complete/dahdi-linux-complete-2.2.1-rc2+2.2.1-rc2.tar.gz
 tar zxvf dahdi-linux-complete-2.2.1-rc2+2.2.1-rc2.tar.gz
 cd dahdi-linux-complete-2.2.1-rc2+2.2.1-rc2
 sudo apt-get install linux-headers-2.6.28-17-server
 make all
 make install
 make config
}}}

This command will change based on what version of kernel you are using, if you get an error when doing "make all" asking for missing linux headers then you have to changed this command to appropriate.  You can use {{{apt-cache search linux-headers}}} to find the available linux-headers
{{{
sudo apt-get install linux-headers-2.6.28-17-server
}}}